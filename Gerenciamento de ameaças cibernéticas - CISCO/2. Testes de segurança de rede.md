# Scanners de Vulnerabilidade
Software que avalia sistemas, redes ou aplicações em busca de pontos fracos, automatizando a auditoria de segurança e priorizando os riscos encontrados.

## O que um scanner procura
-   Uso de senhas padrão ou fracas.
-   Patches de segurança ausentes.
-   Portas de rede abertas.
-   Erros de configuração em softwares e sistemas operacionais.
-   Endereços IP ativos e dispositivos inesperados na rede.

## Funções principais
-   Executar auditorias de conformidade (compliance).
-   Auxiliar no gerenciamento de patches e atualizações.
-   Identificar configurações incorretas.
-   Suportar a verificação de dispositivos móveis e sem fio.
-   Rastrear malware.
-   Identificar dados confidenciais.

## Scanners comuns no mercado
-   Nessus
-   Retina
-   Core Impact
-   GFI LanGuard

# Tipos de Varreduras de Vulnerabilidade
Ao escolher um scanner, deve-se avaliar critérios como precisão, confiabilidade, escalabilidade e qualidade dos relatórios.

## Categorias de Scanners
-   **Scanners de Rede:** Verificam hosts em busca de portas abertas, informações de usuários e vulnerabilidades de rede conhecidas.
-   **Scanners de Aplicação:** Analisam o código-fonte de uma aplicação para encontrar falhas "de dentro para fora", sem executá-la.
-   **Scanners de Aplicação Web:** Focados em identificar vulnerabilidades específicas de aplicações web.

## Abordagens da Varredura
-   **Invasiva:** Tenta ativamente explorar uma vulnerabilidade. Pode causar instabilidade ou travar o alvo.
-   **Não Invasiva:** Identifica a vulnerabilidade sem tentar explorá-la, buscando não causar danos.
-   **Credenciada:** Utiliza credenciais (usuário e senha) para autenticar no sistema e obter informações detalhadas, agindo como um "insider".
-   **Não Credenciada (ou Sem Credenciais):** Simula a visão de um atacante externo, sem acesso autenticado ao sistema.

## Erros Comuns nos Resultados
-   **Falso Positivo:** O scanner reporta uma vulnerabilidade que, na verdade, não existe.
-   **Falso Negativo:** O scanner falha em identificar uma vulnerabilidade que realmente existe.

> **Nota:** Varreduras credenciadas geralmente resultam em menos falsos positivos e falsos negativos.

# Automação de Segurança: SIEM e SOAR
Abordagens automatizadas para gerenciamento e resposta a eventos de segurança.

## SIEM (Security Information and Event Management)
Sistema que agrega e correlaciona dados de logs de diversas fontes (dispositivos de rede, servidores, etc.) para identificar desvios do comportamento padrão.

### Objetivos
-   Detectar ameaças internas e externas.
-   Monitorar a atividade de usuários e o uso de recursos.
-   Gerar relatórios de conformidade para auditorias.
-   Auxiliar na resposta a incidentes.

### Ações e Recursos
-   Ao detectar uma anomalia, pode registrar informações adicionais, gerar alertas ou acionar outros controles de segurança.
-   Sistemas avançados incluem **Análise de Comportamento de Usuários e Entidades (UEBA)** para identificar ameaças com base em padrões de comportamento.

### Considerações
-   Implementação complexa devido ao alto volume de dados.
-   Custo elevado de aquisição e manutenção.
-   Ideal para empresas que geram milhões de eventos por dia.

## SOAR (Security Orchestration, Automation, and Response)
Ferramenta que coleta dados de ameaças de múltiplas fontes e automatiza a resposta a eventos de segurança de nível inferior, sem necessidade de intervenção humana.

### Recursos Principais
-   Gerenciamento de ameaças e vulnerabilidades.
-   Operações de segurança e resposta a incidentes.

> **Nota:** O SOAR pode ser integrado a uma solução SIEM para ampliar as capacidades de automação e resposta.

# Segurança das Operações (OpSec)
Conjunto de práticas diárias para implantar e manter um sistema seguro ao longo de todo o seu ciclo de vida.

## Fases de Atuação
-   **Planejamento e Implementação:**
    -   Análise de projetos.
    -   Identificação de riscos e vulnerabilidades.
    -   Adaptações de segurança antes da implantação.
-   **Operação e Manutenção:**
    -   Atividades contínuas após a configuração da rede.
    -   Garantir que o ambiente, sistemas e aplicações continuem funcionando de forma segura.

## Conhecimentos Essenciais para Testes de Segurança
A equipe responsável pelos testes (manuais ou automatizados) deve ter conhecimento em:

-   Sistemas operacionais.
-   Programação básica.
-   Protocolos de rede (ex: TCP/IP).
-   Vulnerabilidades de rede e mitigação de riscos.
-   Hardening de dispositivos.
-   Firewalls.
-   Sistemas de Prevenção de Intrusão (IPS).

# Teste e Avaliação de Segurança da Rede
Processo para verificar a eficácia das implementações de segurança em uma rede, garantindo que operem conforme o esperado antes que uma ameaça real ocorra.

## Fases de Teste
-   **Fase de Implementação:** Os testes são realizados em partes específicas da rede à medida que são implementadas.
-   **Fase Operacional:** Após a rede estar integrada, realiza-se um **Teste e Avaliação de Segurança (ST&E)** completo.

## ST&E (Teste e Avaliação de Segurança)
Exame detalhado das medidas de proteção aplicadas em uma rede que já está em operação.

### Objetivos do ST&E
1.  Descobrir falhas de design, implementação e operação que possam violar a política de segurança.
2.  Verificar se os mecanismos de segurança são adequados para aplicar a política.
3.  Avaliar a consistência entre a documentação do sistema e sua implementação real.

## Frequência dos Testes
Os testes devem ser repetidos:

-   Periodicamente.
-   Sempre que houver uma alteração no sistema.
-   Com maior frequência em sistemas críticos ou expostos a ameaças constantes.

> **Nota:** É fundamental documentar os resultados dos testes e compartilhá-los com as equipes de TI para auxiliar na análise de riscos e no planejamento de contingência.

# Tipos de Testes de Rede
Diferentes testes realizados para avaliar o status de segurança de uma rede em operação.

-   **Teste de Penetração (Pentest):**
    Simula um ataque malicioso para determinar a viabilidade e as possíveis consequências de uma invasão real. Pode incluir engenharia social e acesso físico.

-   **Varredura de Rede:**
    Identifica hosts ativos, portas abertas e recursos compartilhados (usuários, grupos) para que os administradores possam fortalecer a rede.

-   **Varredura de Vulnerabilidade:**
    Detecta fraquezas potenciais, como erros de configuração, senhas padrão/em branco ou alvos de ataques DoS (Negação de Serviço).

-   **Cracking de Senha:**
    Utiliza software para testar e identificar senhas fracas que violam as políticas de segurança e precisam ser alteradas.

-   **Revisão de Log:**
    Análise de logs de segurança, geralmente com ferramentas de filtragem, para descobrir atividades anormais e ameaças potenciais.

-   **Verificadores de Integridade:**
    Detectam e reportam alterações não autorizadas em arquivos de sistema. Podem também monitorar atividades de login e logout.

-   **Detecção de Vírus:**
    Uso de software antimalware para identificar e remover vírus e outros tipos de software malicioso.

> **Nota:** Testes legados, como *Wardialing* (discagem em massa) e *War Driving* (busca por redes Wi-Fi), ainda podem ser considerados em avaliações de segurança.

# Aplicação dos Resultados de Testes de Rede
Os resultados dos testes de segurança podem ser utilizados para:

-   Definir atividades de mitigação para as vulnerabilidades encontradas.
-   Criar uma referência (baseline) para acompanhar o progresso no cumprimento dos requisitos de segurança.
-   Avaliar o estado atual da implementação dos controles de segurança.
-   Realizar análises de custo-benefício para justificar melhorias.
-   Aprimorar outras atividades, como avaliações de risco e processos de certificação.
-   Servir como ponto de partida para ações corretivas.

# Ferramentas de Teste de Rede
Existem diversas ferramentas, tanto de código aberto quanto comerciais (licenciadas), para testar a segurança de redes e sistemas.

-   **Nmap / Zenmap:**
    Usado para descobrir hosts e serviços em uma rede, criando um "mapa" da mesma.

-   **SuperScan:**
    Scanner de portas que detecta portas TCP/UDP abertas, identifica os serviços em execução e executa consultas (Whois, Ping, etc.).

-   **SIEM (Security Information and Event Management):**
    Tecnologia que fornece relatórios em tempo real e análise de longo prazo de eventos de segurança em ambientes corporativos.

-   **GFI LanGuard:**
    Scanner de rede e segurança que detecta vulnerabilidades.

-   **Tripwire:**
    Ferramenta de verificação de integridade que avalia e valida configurações de TI com base em políticas internas e padrões de conformidade.

-   **Nessus:**
    Software de varredura de vulnerabilidades com foco em acesso remoto, erros de configuração e ataques DoS.

-   **L0phtCrack:**
    Aplicação para auditoria e recuperação de senhas.

-   **Metasploit:**
    Framework que fornece informações sobre vulnerabilidades e auxilia em testes de penetração e no desenvolvimento de assinaturas para IDS.

> **Nota:** A lista inclui algumas ferramentas legadas e serve para exemplificar os diferentes tipos de ferramentas disponíveis, já que a área evolui rapidamente.

# Nmap e Zenmap
**Nmap** é um scanner de rede de baixo nível, amplamente utilizado para mapeamento de rede e reconhecimento. **Zenmap** é a sua interface gráfica (GUI).

## Funcionalidades Básicas
-   **Port Scanning (TCP/UDP):** Procura por múltiplos serviços em um único host.
-   **Port Sweeping (TCP/UDP):** Procura pelo mesmo serviço em múltiplos hosts.
-   **Varreduras Furtivas (Stealth Scans):** Semelhante às varreduras clássicas, mas projetadas para serem mais difíceis de detectar por firewalls ou IPS.
-   **Identificação de Sistema Operacional Remoto:** Técnica conhecida como *OS Fingerprinting*.

## Recursos Avançados
-   **Varredura de Protocolo (Camada 3):** Identifica quais protocolos da Camada 3 são suportados por um host, como GRE e OSPF.

## Uso e Considerações
-   **Dupla Utilidade:** Pode ser usado tanto para testes de segurança legítimos quanto para atividades maliciosas.
-   **Mascaramento:** Possui recursos para usar hosts "falsos" (decoys) para mascarar a origem real da varredura.
-   **Limitação:** Não possui funcionalidades de análise da camada de aplicação (Camada 7).
-   **Plataformas:** Disponível para UNIX, Linux, Windows e OS X.

# SuperScan
Ferramenta de varredura de portas desenvolvida para o sistema operacional Microsoft Windows.

> **Nota:** Requer privilégios de administrador para ser executada.

## Recursos Principais
-   Velocidade de varredura ajustável.
-   Suporte para faixas de IP ilimitadas.
-   Detecção de hosts aprimorada usando múltiplos métodos ICMP.
-   Varredura do tipo TCP SYN.
-   Varredura UDP (utilizando dois métodos diferentes).
-   Geração de relatórios simples em formato HTML.
-   Extensa capacidade de captura de banners (*banner grabbing*).
-   Randomização da ordem da varredura de IPs e portas.
-   Ferramentas úteis integradas (ping, traceroute, whois).
-   Recursos amplos para enumeração de hosts Windows.

---
Ferramentas como SuperScan e Nmap são eficazes para testes de penetração e para determinar vulnerabilidades, mas não preparam um administrador para todos os cenários de segurança possíveis.

# SIEM (Security Information and Event Management)
Tecnologia usada em empresas para fornecer relatórios em tempo real e análise de longo prazo de eventos de segurança. Evoluiu da junção de duas tecnologias: **SIM** (Security Information Management) e **SEM** (Security Event Management).

Pode ser implementado como software, dispositivo (appliance) ou serviço gerenciado.

## Funções Essenciais
-   **Correlação:**
    Analisa logs e eventos de diferentes sistemas e aplicações para acelerar a detecção de ameaças.

-   **Agregação:**
    Reduz o volume de dados ao consolidar registros de eventos duplicados.

-   **Análise Forense:**
    Permite pesquisar logs de toda a organização, fornecendo dados completos para investigações.

-   **Retenção e Relatórios:**
    Armazena dados e os apresenta em painéis de monitoramento em tempo real e em resumos de longo prazo.

## Tipos de Informações Coletadas
O SIEM fornece detalhes sobre a origem de atividades suspeitas, incluindo:

-   **Informações do Usuário:**
    -   Nome, status de autenticação, localização, grupo de autorização.
-   **Informações do Dispositivo:**
    -   Fabricante, modelo, versão do SO, endereço MAC, método de conexão.
-   **Informações de Postura (Compliance):**
    -   Conformidade com a política de segurança, versão do antivírus, patches do SO.

## Perguntas Críticas que o SIEM Ajuda a Responder
-   Quem está associado a este evento?
-   É um usuário com acesso a dados sensíveis?
-   O usuário tem autorização para acessar este recurso?
-   Que tipo de dispositivo está sendo usado?
-   Este evento representa um problema de conformidade?

# Teste de Penetração (Pen Test)
Método para avaliar a segurança de sistemas simulando um ataque real, utilizando as mesmas técnicas que um invasor malicioso usaria. O objetivo é obter acesso não autorizado para identificar e explorar fraquezas.

Permite que a empresa entenda como seus sistemas resistiriam a um ataque e corrija as vulnerabilidades antes que sejam exploradas por criminosos.

## Diferença: Pen Test vs. Teste de Vulnerabilidade
-   **Teste de Vulnerabilidade:** Apenas **identifica** e lista as possíveis falhas de segurança.
-   **Teste de Penetração:** Vai além da identificação e tenta ativamente **explorar** as vulnerabilidades para invadir o sistema.

> Também conhecido como **Hacking Ético**.

## Níveis de Pen Test
-  **Caixa preta:**
	-  O especialista realiza o teste sem conhecimentos sobre o sistema.
-  **Caixa cinza:**
	-  O especialista terá um conhecimento limitado sobre o sistema.
-  **Caixa branca:**
	-  O especialista terá total conhecimento sobre o sistema. Esse é o mais demorado e caro.

# Fases do Teste de Penetração
Um teste de penetração é normalmente dividido em quatro fases sequenciais.

### 1. Planejamento
-   Nesta fase inicial, são estabelecidas as metas e as "regras de engajamento" do teste. Define-se o escopo, os limites e as permissões junto ao cliente.

### 2. Descoberta (Reconhecimento)
-   Fase de coleta de informações sobre o alvo. Pode ser dividida em duas abordagens:
    -   **Passiva (Footprinting):** Coleta de informações de fontes públicas (site da empresa, registros DNS, etc.) sem interagir diretamente com o alvo.
    -   **Ativa:** Interação direta com o alvo para obter informações, como através de uma varredura de portas.

### 3. Ataque (Exploração)
-   Utilizando as informações da fase de descoberta, o testador tenta ativamente explorar as vulnerabilidades para ganhar acesso ao sistema. Esta fase pode incluir:
    -   **Escalação de Privilégios:** Tentar obter permissões de acesso mais elevadas (ex: de usuário comum para administrador).
    -   **Movimento Lateral:** Usar um sistema comprometido para "pular" e acessar outros sistemas dentro da mesma rede.
    -   **Persistência:** Instalar ferramentas ou *backdoors* para manter o acesso ao sistema por mais tempo.
    -   **Limpeza:** Remover artefatos e vestígios da invasão para apagar os rastros.

### 4. Geração de Relatórios
-   Fase final onde o testador documenta todo o processo. O relatório detalha as vulnerabilidades encontradas, as ações realizadas, os resultados obtidos e as recomendações para correção.

# Tipos de Exercícios de Segurança (Equipes)
Para simulações de segurança mais complexas e longas que um Pen Test padrão, as empresas podem organizar exercícios com equipes distintas, cada uma com um papel específico.

-   **Time Vermelho (Red Team):**
    -   **Função:** A equipe de ataque (o adversário).
    -   **Objetivo:** Tentar invadir os sistemas e a rede, explorando vulnerabilidades sem ser detectado.

-   **Time Azul (Blue Team):**
    -   **Função:** A equipe de defesa.
    -   **Objetivo:** Detectar, responder e neutralizar as tentativas de ataque do Time Vermelho, protegendo os ativos da organização.

-   **Time Branco (White Team):**
    -   **Função:** A equipe neutra (o árbitro).
    -   **Objetivo:** Definir as regras e os objetivos do exercício, supervisionar a competição e garantir que tudo corra conforme o planejado. Geralmente possui conhecimento em governança e conformidade.

-   **Time Roxo (Purple Team):**
    -   **Função:** Uma equipe colaborativa.
    -   **Objetivo:** Une membros das equipes Vermelha e Azul para trabalharem juntos. O foco é compartilhar conhecimentos, identificar vulnerabilidades e melhorar os controles de segurança de forma cooperativa, em vez de competitiva.

> **Nota:** Além dos times, empresas também possuem programas abertos de recompensas para quem encontrar falhas (Bug Bounty).

# Analisador de Pacotes (Packet Analyzer)
Ferramenta que intercepta e registra o tráfego que passa por uma rede digital. Também é conhecido como *packet sniffer*.

Pode ser utilizado tanto para fins legítimos (como análise e solução de problemas) quanto para fins ilegítimos (como espionagem e roubo de dados).

## Funções Principais

-   **Análise de problemas de rede:**
    Ajuda a diagnosticar falhas de comunicação e lentidão.
-   **Detecção de tentativas de invasão:**
    Identifica tráfego anômalo ou malicioso.
-   **Isolamento de sistemas comprometidos:**
    Auxilia a identificar quais máquinas na rede foram exploradas.
-   **Log de tráfego:**
    Grava a comunicação para auditoria ou análise forense posterior.
-   **Detecção de uso indevido da rede:**
    Verifica se a rede está sendo usada para atividades não autorizadas ou contra as políticas da empresa.

# Sniffing e Análise de Protocolos
**Sniffing** (ou interceptação de pacotes) é o ato de "espionar" o tráfego de uma rede. Um invasor examina todos os dados que passam por sua placa de rede, mesmo que não sejam destinados a ele.

A interceptação pode ser feita com software, hardware ou uma combinação de ambos.

## Uso Legítimo vs. Malicioso
O sniffing não é uma atividade exclusivamente maliciosa.

-   **Uso Legítimo (Administradores de Rede):**
    -   Analisar o tráfego da rede.
    -   Identificar e solucionar problemas de largura de banda.
    -   Diagnosticar outras falhas de rede.

-   **Uso Malicioso (Invasores):**
    -   Capturar informações sensíveis, como logins e senhas.
    -   Monitorar a atividade dos usuários.

## Escopo da Análise
Um analisador de pacotes pode ser configurado para:

-   Capturar **todo o tráfego** de rede.
-   Focar em um **protocolo ou serviço específico**.
-   Buscar por **sequências de caracteres específicas** (como "password").
-   **Modificar o tráfego** interceptado, alterando-o parcial ou totalmente.

> **Nota:** A segurança física é um controle importante para evitar que dispositivos *sniffers* não autorizados sejam conectados fisicamente à rede interna.

# Ferramentas de Linha de Comando
Conjunto de utilitários essenciais, executados via terminal, para diagnóstico, gerenciamento e auditoria de redes.

-   **ipconfig / ifconfig:**
    -   Exibe as configurações de TCP/IP da máquina (endereço IP, máscara, gateway, DNS). `ifconfig` é o equivalente para Mac/Linux.

-   **ping:**
    -   Testa a conectividade com um host enviando uma solicitação ICMP para verificar se ele está alcançável.

-   **arp:**
    -   Exibe a tabela que mapeia endereços IP para os endereços MAC correspondentes na rede local.

-   **tracert / traceroute:**
    -   Rastreia a rota que um pacote percorre até seu destino, mostrando cada "salto" (roteador) no caminho. `traceroute` é o equivalente para Mac/Linux.

-   **nslookup / dig:**
    -   Consulta servidores DNS para solucionar problemas ou obter informações de registros. `dig` é o equivalente mais comum em Mac/Linux.

-   **netstat:**
    -   Mostra todas as portas em que um computador está "ouvindo" e exibe as conexões de rede ativas.

-   **nbtstat:**
    -   Ajuda a solucionar problemas de resolução de nomes NetBIOS em sistemas Windows.

-   **nmap:**
    -   Ferramenta poderosa para auditoria de segurança. Localiza hosts, detecta sistemas operacionais e identifica serviços em execução.

-   **netcat:**
    -   Coleta informações de conexões TCP/UDP. Pode ser usado para varredura de portas, captura de banner e transferência de arquivos.

-   **hping:**
    -   Ferramenta avançada para montar e analisar pacotes customizados. Usada para varredura de portas, descoberta de caminho, identificação de SO e testes de firewall.